import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as e,b as n,o as a}from"./app-BMihMyie.js";const t={};function l(r,s){return a(),e("div",null,[...s[0]||(s[0]=[n(`<h2 id="partitioning" tabindex="-1"><a class="header-anchor" href="#partitioning"><span>Partitioning</span></a></h2><div class="language-console line-numbers-mode" data-highlighter="shiki" data-ext="console" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-console"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$ lsblk --output NAME,FSTYPE,LABEL,PARTTYPENAME,SIZE,MOUNTPOINT</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">NAME        FSTYPE     LABEL     PARTTYPENAME          SIZE MOUNTPOINT</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">nvme0n1                                                3.7T</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">├─nvme0n1p1 vfat       EFI       EFI System              1G /boot/efi</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">├─nvme0n1p2 vfat       Boot      Microsoft basic data    3G /boot</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">└─nvme0n1p3 zfs_member zpcachyos Linux filesystem      3.7T</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><a href="https://wiki.archlinux.org/title/GRUB/Tips_and_tricks#Recall_previous_entry" target="_blank" rel="noopener noreferrer">https://wiki.archlinux.org/title/GRUB/Tips_and_tricks#Recall_previous_entry</a></li></ul><p><code>GRUB_SAVEDEFAULT=true</code> will only work if <code>/boot/grub</code> is not on btrfs / ZFS, because GRUB cannot write to btrfs / ZFS.</p><h2 id="how-to-disable-zram" tabindex="-1"><a class="header-anchor" href="#how-to-disable-zram"><span>How to disable zram?</span></a></h2><ul><li><a href="https://askubuntu.com/a/1419240" target="_blank" rel="noopener noreferrer">https://askubuntu.com/a/1419240</a></li></ul><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sh"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># /etc/default/grub</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">GRUB_CMDLINE_LINUX_DEFAULT</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;systemd.zram=0&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="specifying-boot-id-has-no-effect-no-persistent-journal-was-found" tabindex="-1"><a class="header-anchor" href="#specifying-boot-id-has-no-effect-no-persistent-journal-was-found"><span>Specifying boot ID has no effect, no persistent journal was found.</span></a></h2><ul><li><a href="https://discourse.practicalzfs.com/t/psa-systemd-journal-persistence-settings-and-race-condition-between-zfs-mount-service-and-systemd-journald-service/1929" target="_blank" rel="noopener noreferrer">https://discourse.practicalzfs.com/t/psa-systemd-journal-persistence-settings-and-race-condition-between-zfs-mount-service-and-systemd-journald-service/1929</a></li></ul><blockquote><p>With your persistent journal being stored on a ZFS filesystem, there is now a race condition on startup beween <code>zfs-mount.service</code>, which will mount your <code>/var/log</code> directory, and <code>systemd-journald.service</code>, which will try to write to it before it’s been mounted. This can cause <code>systemd-journald</code> to fall back to using an in-memory journal, or result in unpredictable loging behaviour</p><p>The fix is to create a dependency for <code>systemd-journald.service</code> on <code>zfs-mount.service</code>:</p></blockquote><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-ini"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># /etc/systemd/system/systemd-journald.service.d/zfs.conf</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">[Unit]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">After</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> zfs-mount.service</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">Requires</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> zfs-mount.service</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,11)])])}const h=i(t,[["render",l]]),d=JSON.parse('{"path":"/2025/2025-04-26-install-cachyos-on-zfs.html","title":"Install CachyOS on ZFS","lang":"en-US","frontmatter":{"date":"2025-04-26T15:55:35.000Z","modified":"2025-09-20T10:37:51.000Z","tags":["Dotfiles","OS/Linux/Arch","OS/Linux/Arch/CachyOS"],"title":"Install CachyOS on ZFS","description":"Partitioning https://wiki.archlinux.org/title/GRUB/Tips_and_tricks#Recall_previous_entry GRUB_SAVEDEFAULT=true will only work if /boot/grub is not on btrfs / ZFS, because GRUB c...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Install CachyOS on ZFS\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2025-04-26T15:55:35.000Z\\",\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"liblaf\\",\\"url\\":\\"https://github.com/liblaf\\"}]}"],["meta",{"property":"og:url","content":"https://hope.liblaf.me/2025/2025-04-26-install-cachyos-on-zfs.html"}],["meta",{"property":"og:site_name","content":"liblaf"}],["meta",{"property":"og:title","content":"Install CachyOS on ZFS"}],["meta",{"property":"og:description","content":"Partitioning https://wiki.archlinux.org/title/GRUB/Tips_and_tricks#Recall_previous_entry GRUB_SAVEDEFAULT=true will only work if /boot/grub is not on btrfs / ZFS, because GRUB c..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"article:tag","content":"OS/Linux/Arch/CachyOS"}],["meta",{"property":"article:tag","content":"OS/Linux/Arch"}],["meta",{"property":"article:tag","content":"Dotfiles"}],["meta",{"property":"article:published_time","content":"2025-04-26T15:55:35.000Z"}]]},"git":{},"readingTime":{"minutes":0.71,"words":212},"filePathRelative":"2025/2025-04-26-install-cachyos-on-zfs.md","excerpt":"<h2>Partitioning</h2>\\n<div class=\\"language-console line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"console\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code class=\\"language-console\\"><span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">$ lsblk --output NAME,FSTYPE,LABEL,PARTTYPENAME,SIZE,MOUNTPOINT</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">NAME        FSTYPE     LABEL     PARTTYPENAME          SIZE MOUNTPOINT</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">nvme0n1                                                3.7T</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">├─nvme0n1p1 vfat       EFI       EFI System              1G /boot/efi</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">├─nvme0n1p2 vfat       Boot      Microsoft basic data    3G /boot</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">└─nvme0n1p3 zfs_member zpcachyos Linux filesystem      3.7T</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}');export{h as comp,d as data};
